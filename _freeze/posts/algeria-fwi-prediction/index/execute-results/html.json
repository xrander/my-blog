{
  "hash": "0444553ad93928752c89b63d05b86ce0",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Prediction of Fire Occurrence in Algeria's Forest\"\ndate: \"2024-08-4\"\ncategories: [Machine Learning, Logistic Regression, PCA]\ncode-fold: true\ncode-copy: hover\ncode-summary: \"Show the code\"\nimage: image.jpg\ndraft: false\nbibliography: references.bib\n---\n\n\n# Introduction\n\nAccording to the World Bank, Algeria's forest is about 0.82% of the total country's land mass in 2021 ([tradingeconomics.com](https://tradingeconomics.com/algeria/forest-area-percent-of-land-area-wb-data.html)). Algeria is one of the Maghreb countries affected by wildfire. Given the troubles associated with wildfire, it is important to assess and predict the potential for wildfire activity. One of the ways to predict the potential for wildfire is associating its occurrence with weather conditions. This is called the **Fire Weather Index** (FWI). FWI was developed by the Canadian Forest Service and it is a key component of the Canadian Forest Fire Weather Index System. FWI is also used internationally to assess fire danger and predict wildfire behavior based on weather conditions. ![Forest Fire - source:aljazeer.com](image2.jpg)\n\n## Objective\n\nFor this project, I will predict the occurrence of fire (fire or nor fire) given a set of parameters related to FWI in two regions of Algeria, the Bejaia region located in the northeast of Algeria and Sidi Bel-abbes region located in the northwest of Algeria.\n\n## Data\n\nThe data for this analysis is collected from UCI machine learning data repository and provided by [@abid2020]. The variables include:\n\n|Variable name|Data type|Definition|\n|:------|:------:|--------:|\n|region|categorical| area in Algeria, either of Sidi Bel-abbes or Bejaia|\n|day|date|the day in number|\n|month|date|month of the year, from June to September|\n|year|date|single year of when data as observed|\n|temp|numeric|max noon temperature in $^{\\circ}C$|\n|rh|numeric|relative humidity in percentage|\n|ws|numeric|wind speed in km/h|\n|rain|numeric|total rain in a day in mm|\n|ffmc|numeric|fine fuel moisture code|\n|dmc|numeric|Duff moisture code|\n|dc|numeric|drought code|\n|isi|numeric|Initial spread index|\n|bui|numeric|buildup index|\n|fwi|numeric|fire weather index|\n|classes|binary|class of fire occurrence. This is the target variable|\n\nTo get started I load all necessary packages. Tidyverse for all forms of data manipulation, visualization and data importation and tidymodels for our model workflow.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(pacman)\np_load(tidyverse, tidymodels, knitr, ggthemes, hrbrthemes)\ntheme_set(theme_ipsum_ps(base_size = 12))\n```\n:::\n\n \n:::{.callout-important appearance=simple}\nI like using the `pacman` package instead of using base R's `library()` function because it simplifies library management and integration. Another packagem management system is pkgdown.\n::: \n\nNext I import the data\n\n::: {.cell}\n\n```{.r .cell-code}\nalgeria_ff <- read_csv(\"data/Algerian_forest_fires_dataset_UPDATE.csv\", skip = 1) |> \n  janitor::clean_names()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: One or more parsing issues, call `problems()` on your data frame for details,\ne.g.:\n  dat <- vroom(...)\n  problems(dat)\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 246 Columns: 14\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (14): day, month, year, Temperature, RH, Ws, Rain, FFMC, DMC, DC, ISI, B...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n:::\n\n\n# Data Understanding\nAfter importing the data, I need to investigate if the data is imported as expected, and confirm that all data types are as expected.\n\n## Data Preview\nA quick preview of the data is the first step:\n\n::: {#tbl-data-preview .cell tbl-cap='Data preview' tbl-subcap='true'}\n\n```{.r .cell-code}\nalgeria_ff |> \n  head() |> \n  kable()\n```\n\n::: {.cell-output-display}\n\n\n|day |month |year |temperature |rh |ws |rain |ffmc |dmc |dc   |isi |bui |fwi |classes  |\n|:---|:-----|:----|:-----------|:--|:--|:----|:----|:---|:----|:---|:---|:---|:--------|\n|01  |06    |2012 |29          |57 |18 |0    |65.7 |3.4 |7.6  |1.3 |3.4 |0.5 |not fire |\n|02  |06    |2012 |29          |61 |13 |1.3  |64.4 |4.1 |7.6  |1   |3.9 |0.4 |not fire |\n|03  |06    |2012 |26          |82 |22 |13.1 |47.1 |2.5 |7.1  |0.3 |2.7 |0.1 |not fire |\n|04  |06    |2012 |25          |89 |13 |2.5  |28.6 |1.3 |6.9  |0   |1.7 |0   |not fire |\n|05  |06    |2012 |27          |77 |16 |0    |64.8 |3   |14.2 |1.2 |3.9 |0.5 |not fire |\n|06  |06    |2012 |31          |67 |14 |0    |82.6 |5.8 |22.2 |3.1 |7   |2.5 |fire     |\n\n\n:::\n\n```{.r .cell-code}\nalgeria_ff |> \n  tail() |> \n  kable()\n```\n\n::: {.cell-output-display}\n\n\n|day |month |year |temperature |rh |ws |rain |ffmc |dmc  |dc   |isi |bui  |fwi |classes  |\n|:---|:-----|:----|:-----------|:--|:--|:----|:----|:----|:----|:---|:----|:---|:--------|\n|25  |09    |2012 |28          |70 |15 |0    |79.9 |13.8 |36.1 |2.4 |14.1 |3   |not fire |\n|26  |09    |2012 |30          |65 |14 |0    |85.4 |16   |44.5 |4.5 |16.9 |6.5 |fire     |\n|27  |09    |2012 |28          |87 |15 |4.4  |41.1 |6.5  |8    |0.1 |6.2  |0   |not fire |\n|28  |09    |2012 |27          |87 |29 |0.5  |45.9 |3.5  |7.9  |0.4 |3.4  |0.2 |not fire |\n|29  |09    |2012 |24          |54 |18 |0.1  |79.7 |4.3  |15.2 |1.7 |5.1  |0.7 |not fire |\n|30  |09    |2012 |24          |64 |15 |0.2  |67.3 |3.8  |16.5 |1.2 |4.8  |0.5 |not fire |\n\n\n:::\n\n```{.r .cell-code}\nalgeria_ff |> \n  car::some() |> \n  kable()\n```\n\n::: {.cell-output-display}\n\n\n|day |month |year |temperature |rh |ws |rain |ffmc |dmc  |dc    |isi  |bui  |fwi  |classes  |\n|:---|:-----|:----|:-----------|:--|:--|:----|:----|:----|:-----|:----|:----|:----|:--------|\n|25  |07    |2012 |31          |65 |18 |0    |84.3 |12.5 |88.7  |4.8  |18.5 |7.3  |fire     |\n|11  |06    |2012 |31          |42 |21 |0    |90.6 |18.2 |30.5  |13.4 |18   |16.7 |fire     |\n|22  |06    |2012 |33          |46 |14 |1.1  |78.3 |8.1  |8.3   |1.9  |7.7  |1.2  |not fire |\n|03  |07    |2012 |34          |56 |17 |0.1  |84.7 |9.7  |27.3  |4.7  |10.3 |5.2  |fire     |\n|06  |07    |2012 |35          |42 |15 |0.3  |84.7 |15.5 |45.1  |4.3  |16.7 |6.3  |fire     |\n|16  |07    |2012 |31          |83 |17 |0    |84.5 |19.4 |33.1  |4.7  |19.2 |7.3  |fire     |\n|29  |07    |2012 |34          |59 |16 |0    |88.1 |19.5 |47.2  |7.4  |19.5 |10.9 |fire     |\n|31  |07    |2012 |37          |55 |15 |0    |89.3 |28.3 |67.2  |8.3  |28.3 |14.5 |fire     |\n|03  |09    |2012 |28          |75 |16 |0    |82.2 |4.4  |24.3  |3.3  |6    |2.5  |fire     |\n|23  |09    |2012 |35          |56 |14 |0    |89   |29.4 |115.6 |7.5  |36   |15.2 |fire     |\n\n\n:::\n:::\n\n@tbl-data-preview shows the first six observations, @tbl-data-preview-1, the last six observations, @tbl-data-preview-2, and 10 random observations from the data, @tbl-data-preview-3.\n\nFrom @tbl-data-prop, all the variables are character when they should be majorly numeric and one or two categorical variable. I can also see that the regions are not indicated in the data. The variables present are day, month, year, temperature, rh, ws, rain, ffmc, dmc, dc, isi, bui, fwi, classes. \n\n\n\n::: {#tbl-data-prop .cell tbl-cap='Data Properties' tbl-subcap='true'}\n\n```{.r .cell-code}\nskimr::skim(algeria_ff)\n```\n\n::: {.cell-output-display}\n\nTable: Data summary\n\n|                         |           |\n|:------------------------|:----------|\n|Name                     |algeria_ff |\n|Number of rows           |246        |\n|Number of columns        |14         |\n|_______________________  |           |\n|Column type frequency:   |           |\n|character                |14         |\n|________________________ |           |\n|Group variables          |None       |\n\n\n**Variable type: character**\n\n|skim_variable | n_missing| complete_rate| min| max| empty| n_unique| whitespace|\n|:-------------|---------:|-------------:|---:|---:|-----:|--------:|----------:|\n|day           |         0|          1.00|   2|  29|     0|       33|          0|\n|month         |         1|          1.00|   2|   5|     0|        5|          0|\n|year          |         1|          1.00|   4|   4|     0|        2|          0|\n|temperature   |         1|          1.00|   2|  11|     0|       20|          0|\n|rh            |         1|          1.00|   2|   2|     0|       63|          0|\n|ws            |         1|          1.00|   1|   2|     0|       19|          0|\n|rain          |         1|          1.00|   1|   4|     0|       40|          0|\n|ffmc          |         1|          1.00|   2|   4|     0|      174|          0|\n|dmc           |         1|          1.00|   1|   4|     0|      167|          0|\n|dc            |         1|          1.00|   1|   6|     0|      199|          0|\n|isi           |         1|          1.00|   1|   4|     0|      107|          0|\n|bui           |         1|          1.00|   1|   4|     0|      175|          0|\n|fwi           |         1|          1.00|   1|   4|     0|      127|          0|\n|classes       |         2|          0.99|   4|   8|     0|        3|          0|\n\n\n:::\n:::\n\n\n## Missing Data\nThere's a maximum of two missing data, which is in the `classes` variable, @tbl-data-prop-2. I will investigate this:\n\n\n::: {#tbl-missing .cell tbl-cap='Missing data'}\n\n```{.r .cell-code}\nalgeria_ff |> \n  filter(is.na(classes)) |>  kable()\n```\n\n::: {.cell-output-display}\n\n\n|day                           |month |year |temperature |rh |ws |rain |ffmc |dmc  |dc     |isi  |bui  |fwi  |classes |\n|:-----------------------------|:-----|:----|:-----------|:--|:--|:----|:----|:----|:------|:----|:----|:----|:-------|\n|Sidi-Bel Abbes Region Dataset |NA    |NA   |NA          |NA |NA |NA   |NA   |NA   |NA     |NA   |NA   |NA   |NA      |\n|14                            |07    |2012 |37          |37 |18 |0.2  |88.9 |12.9 |14.6 9 |12.5 |10.4 |fire |NA      |\n\n\n:::\n:::\n\nThere's an interesting finding in @tbl-missing. The start of Sidi-Bel Abbes region dataset can be seen under the `day` variable. I will add row numbers and a new column called region and add each region according to the row number where Sidi-Bel Abbes appears in the variable `day`. All data before Sidi-Bel Abbes are Bejaia region data,\n\n::: {#tbl-add-row .cell tbl-cap='Row numbers added'}\n\n```{.r .cell-code}\nalgeria_ff <- algeria_ff |> \n  mutate(\n    id = row_number(),\n    .before = day\n  )\nhead(algeria_ff) |> kable()\n```\n\n::: {.cell-output-display}\n\n\n| id|day |month |year |temperature |rh |ws |rain |ffmc |dmc |dc   |isi |bui |fwi |classes  |\n|--:|:---|:-----|:----|:-----------|:--|:--|:----|:----|:---|:----|:---|:---|:---|:--------|\n|  1|01  |06    |2012 |29          |57 |18 |0    |65.7 |3.4 |7.6  |1.3 |3.4 |0.5 |not fire |\n|  2|02  |06    |2012 |29          |61 |13 |1.3  |64.4 |4.1 |7.6  |1   |3.9 |0.4 |not fire |\n|  3|03  |06    |2012 |26          |82 |22 |13.1 |47.1 |2.5 |7.1  |0.3 |2.7 |0.1 |not fire |\n|  4|04  |06    |2012 |25          |89 |13 |2.5  |28.6 |1.3 |6.9  |0   |1.7 |0   |not fire |\n|  5|05  |06    |2012 |27          |77 |16 |0    |64.8 |3   |14.2 |1.2 |3.9 |0.5 |not fire |\n|  6|06  |06    |2012 |31          |67 |14 |0    |82.6 |5.8 |22.2 |3.1 |7   |2.5 |fire     |\n\n\n:::\n:::\n\n\nI will perform the previous filter operation in @tbl-missing to get the start of the row number for Sidi-Bel Abbes Region.\n\n\n::: {#tbl-missing-2 .cell}\n\n```{.r .cell-code}\nalgeria_ff |> \n  filter(is.na(classes))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 15\n     id day    month year  temperature rh    ws    rain  ffmc  dmc   dc    isi  \n  <int> <chr>  <chr> <chr> <chr>       <chr> <chr> <chr> <chr> <chr> <chr> <chr>\n1   123 Sidi-… <NA>  <NA>  <NA>        <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA> \n2   168 14     07    2012  37          37    18    0.2   88.9  12.9  14.6… 12.5 \n# ℹ 3 more variables: bui <chr>, fwi <chr>, classes <chr>\n```\n\n\n:::\n:::\n\nSidi-Bel Abbes data starts from 124, @tbl-missing-2. I will add the regions and remove the id variable that contains the row numbers. The number of observations for each region can be seen in @tbl-region\n\n\n::: {#tbl-region .cell tbl-cap='Number of observations for the regions'}\n\n```{.r .cell-code}\nalgerian_ff <- algeria_ff |> \n  mutate(\n    region = case_when(id <= 122 ~ \"Bejaia\",\n                       .default = \"Sidi-Bel Abbes\"),\n    .before = day,\n    .keep = \"unused\"\n  )\n\nhead(algerian_ff)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 15\n  region day   month year  temperature rh    ws    rain  ffmc  dmc   dc    isi  \n  <chr>  <chr> <chr> <chr> <chr>       <chr> <chr> <chr> <chr> <chr> <chr> <chr>\n1 Bejaia 01    06    2012  29          57    18    0     65.7  3.4   7.6   1.3  \n2 Bejaia 02    06    2012  29          61    13    1.3   64.4  4.1   7.6   1    \n3 Bejaia 03    06    2012  26          82    22    13.1  47.1  2.5   7.1   0.3  \n4 Bejaia 04    06    2012  25          89    13    2.5   28.6  1.3   6.9   0    \n5 Bejaia 05    06    2012  27          77    16    0     64.8  3     14.2  1.2  \n6 Bejaia 06    06    2012  31          67    14    0     82.6  5.8   22.2  3.1  \n# ℹ 3 more variables: bui <chr>, fwi <chr>, classes <chr>\n```\n\n\n:::\n:::\n\n\nNow we can check for missing data again\n\n::: {.cell}\n\n```{.r .cell-code}\nalgerian_ff |> \n  filter(if_any(everything(), is.na)) |> \n  kable()\n```\n\n::: {.cell-output-display}\n\n\n|region         |day                           |month |year |temperature |rh |ws |rain |ffmc |dmc  |dc     |isi  |bui  |fwi  |classes |\n|:--------------|:-----------------------------|:-----|:----|:-----------|:--|:--|:----|:----|:----|:------|:----|:----|:----|:-------|\n|Sidi-Bel Abbes |Sidi-Bel Abbes Region Dataset |NA    |NA   |NA          |NA |NA |NA   |NA   |NA   |NA     |NA   |NA   |NA   |NA      |\n|Sidi-Bel Abbes |14                            |07    |2012 |37          |37 |18 |0.2  |88.9 |12.9 |14.6 9 |12.5 |10.4 |fire |NA      |\n\n\n:::\n:::\n\nThe missing points are still the same. Here, I will remove this data points and proceed with the analysis.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nalgerian_ff <- algerian_ff |> \n  drop_na() |> \n  filter(classes %in% c(\"not fire\", \"fire\"))\n```\n:::\n\n\nI also need to change the other variables to numeric data types except `region` and `classes` which will be changed to factor variable type.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nalgerian_ff <- algerian_ff |> \n  mutate(\n    region = factor(region),\n    classes = ifelse(classes == \"not fire\", 0, 1),\n    classes = factor(classes, labels = c(\"not fire\", \"fire\"), levels = c(0 ,1)),\n    across(where(is.character), parse_number)\n  )\n\nstr(algerian_ff)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ntibble [243 × 15] (S3: tbl_df/tbl/data.frame)\n $ region     : Factor w/ 2 levels \"Bejaia\",\"Sidi-Bel Abbes\": 1 1 1 1 1 1 1 1 1 1 ...\n $ day        : num [1:243] 1 2 3 4 5 6 7 8 9 10 ...\n $ month      : num [1:243] 6 6 6 6 6 6 6 6 6 6 ...\n $ year       : num [1:243] 2012 2012 2012 2012 2012 ...\n $ temperature: num [1:243] 29 29 26 25 27 31 33 30 25 28 ...\n $ rh         : num [1:243] 57 61 82 89 77 67 54 73 88 79 ...\n $ ws         : num [1:243] 18 13 22 13 16 14 13 15 13 12 ...\n $ rain       : num [1:243] 0 1.3 13.1 2.5 0 0 0 0 0.2 0 ...\n $ ffmc       : num [1:243] 65.7 64.4 47.1 28.6 64.8 82.6 88.2 86.6 52.9 73.2 ...\n $ dmc        : num [1:243] 3.4 4.1 2.5 1.3 3 5.8 9.9 12.1 7.9 9.5 ...\n $ dc         : num [1:243] 7.6 7.6 7.1 6.9 14.2 22.2 30.5 38.3 38.8 46.3 ...\n $ isi        : num [1:243] 1.3 1 0.3 0 1.2 3.1 6.4 5.6 0.4 1.3 ...\n $ bui        : num [1:243] 3.4 3.9 2.7 1.7 3.9 7 10.9 13.5 10.5 12.6 ...\n $ fwi        : num [1:243] 0.5 0.4 0.1 0 0.5 2.5 7.2 7.1 0.3 0.9 ...\n $ classes    : Factor w/ 2 levels \"not fire\",\"fire\": 1 1 1 1 1 2 2 2 1 1 ...\n```\n\n\n:::\n:::\n\n\n# Exploratory Data Analyis\nLet's do some exploratory data analysis to understand our target variable, predictors, and the relationship between them.\n## Target Variable\n\n::: {.cell}\n\n```{.r .cell-code}\nalgerian_ff |>\n  count(classes) |> \n  ggplot(aes(classes, n, fill = classes)) +\n  geom_bar(stat = \"identity\") +\n  geom_text(\n    aes(label = n),\n    nudge_y = 11.5,\n    size = 4,\n    col = \"#ff3000\"\n  ) +\n  scale_fill_colorblind() +\n  labs(\n    x = \"Classes\",\n    y = \"Count\",\n    title = \"Frequency of Fire Occurrence Situation\"\n  ) +\n  coord_cartesian(ylim = c(0, 145)) +\n  scale_y_continuous(breaks = seq(0, 145, 29)) +\n  theme(\n    legend.position = \"none\",\n    plot.title = element_text(hjust = .5)\n  )\n```\n\n::: {.cell-output-display}\n![Frequency of Classes](index_files/figure-html/fig-tgt-plot-1.png){#fig-tgt-plot width=672}\n:::\n:::\n\n\n@fig-tgt-plot shows there are more occurrence of fire than not fire.\n\n### Features / Predictors\n\n\n::: {.cell}\n\n```{.r .cell-code}\nalgerian_ff |> \n  select(-classes) |> \n  GGally::ggpairs(\n    title = \"Predictors\"\n  ) +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![Predictors plots](index_files/figure-html/fig-pairs-plot-1.png){#fig-pairs-plot width=672}\n:::\n:::\n\n\nAs show in @fig-pairs-plot, `rain`, `ws`, `dmc`, `dc`, `isi`, `bui` and `fwi` are rightly skewed, `temperature` and `rh` are normally distributed, while `ffmc` is left-skewed. There's also high correlation between some of the variables.\n\n### Target vs Feature\n\n::: {.cell}\n\n```{.r .cell-code}\nalgerian_ff |> \n  summarize(\n    .by = c(classes, region),\n    count = n()\n  ) |> \n  ggplot(aes(region, count, fill = fct_reorder(classes, count))) +\n  geom_col(position = \"dodge\") +\n  geom_text(\n    aes(label = count),\n    size = 3.2,\n    vjust = -.2,\n    position = position_dodge(width = 1)\n    # position = position_nudge(x = 0, y =1)\n  ) +\n  scale_fill_calc() +\n  labs(\n    fill = \"Region\",\n    x = \"Classes\",\n    y = \"Count\",\n    title = \"Frequency of Fire Occurrence Situation Across Regions\",\n    subtitle = \"There's more fire outbreak in Sidi-Bel Abbes than in Bejaia\"\n  ) \n```\n\n::: {.cell-output-display}\n![There are more fire outbreak in  Sidi-Bel Abbes than in Bejaia](index_files/figure-html/fig-reg-class-1.png){#fig-reg-class width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nalgerian_ff |> \n  ggplot(aes(rain, temperature, col = classes)) +\n  geom_jitter() +\n  scale_color_wsj() +\n  labs(\n    x = \"Rain\",\n    y = \"Temperature\",\n    title = \"Temperature vs Rain relationship for Fire Occurrence\",\n    subtitle = \"Fire rarely occur on days with high rainfall\"\n  ) +\n  theme(plot.subtitle = element_text(size = 10))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n::: {#fig-rh-class .cell layout-nrow=\"2\"}\n\n```{.r .cell-code}\nalgerian_ff |> \n  ggplot(aes(day, rh, colour = classes)) +\n  geom_point() +\n  labs(\n    x = \"Day\",\n    y = \"Relative Humidity (%)\",\n    title = \"Fire occurence for each days in a month given the day's humidity\"\n  ) +\n  facet_wrap(~month)\n\nalgerian_ff |> \n  ggplot(aes(day, rh, colour = classes)) +\n  geom_point() +\n  labs(\n    x = \"Day\",\n    y = \"Relative Humidity (%)\",\n    title = \"Fire occurence for each days in a month for a region given the day's humidity\"\n  ) +\n  facet_grid(region~month)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/fig-rh-class-1.png){#fig-rh-class-1 width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/fig-rh-class-2.png){#fig-rh-class-2 width=672}\n:::\n\nRelative humidity of each days across the months showing the occurrence of fire.\n:::\n\n\n@fig-rh-class-1 shows no clear pattern in fire occurrence, but it is visible that the 8th month had more fire occurring from its 10th day to the 27th day. Fire occurred more in days with low relative humidity compared to those with high humidity. @fig-rh-class-2 shows how month 8 had fire occuring the most, even at high relative humidity.\n\n# Modeling\n\nAs introduced earlier, the model algorithm I will be using for this binary classification is logistic regression. The modeling worklow will go as thus:\n\n-   Data sharing\n-   Create resamples\n-   Create model specification\n-   Feature engineering\n-   Workflow and model training\n-   Model evaluation\n-   Model last fit on whole data.\n\n## Data Sharing\nLet's split the data into two portions. The training data will be 70% of the whole data while the test data will be 30%.\n\n\n::: {#tbl-distro .cell tbl-cap='Distribution of the targer variable across regions'}\n\n```{.r .cell-code}\nset.seed(123)\nalgerian_split <- initial_split(algerian_ff, prop = .7)\nalgerian_train <- training(algerian_split)\nalgerian_test <- testing(algerian_split)\nalgerian_train |> \n  count(region, classes)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 3\n  region         classes      n\n  <fct>          <fct>    <int>\n1 Bejaia         not fire    41\n2 Bejaia         fire        48\n3 Sidi-Bel Abbes not fire    32\n4 Sidi-Bel Abbes fire        49\n```\n\n\n:::\n:::\n\n\n@tbl-distro shows how the data is distributed in the training data.\n\n## Model Specification\nNext we create the model specification\n\n::: {.cell}\n\n```{.r .cell-code}\nlr_spec <- logistic_reg() |> \n  set_mode(\"classification\") |> \n  set_engine(\"glm\")\n\nlr_spec |> \n  translate()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nLogistic Regression Model Specification (classification)\n\nComputational engine: glm \n\nModel fit template:\nstats::glm(formula = missing_arg(), data = missing_arg(), weights = missing_arg(), \n    family = stats::binomial)\n```\n\n\n:::\n:::\n\n\n## Feature Engineering\nFor feature engineering, we will remove zero and near-zero variance variables. After, we'll apply Yeo-Johnson to prevent to handle data values that have zero or negative values. After this, we standardize the results and make all factor variables one-hot coded.\n\n::: {.cell}\n\n```{.r .cell-code}\nlr_rec <- recipe(\n  classes ~ . + 1, data = algerian_train\n) |> \n  step_zv(all_numeric_predictors()) |> \n  step_nzv(all_numeric_predictors()) |> \n  step_YeoJohnson(all_numeric_predictors()) |> \n  step_scale(all_numeric_predictors()) |> \n  step_pca(all_numeric_predictors()) |> \n  step_dummy(region)\n  \nlr_rec\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Recipe ──────────────────────────────────────────────────────────────────────\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Inputs \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nNumber of variables by role\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\noutcome:    1\npredictor: 14\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Operations \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n• Zero variance filter on: all_numeric_predictors()\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n• Sparse, unbalanced variable filter on: all_numeric_predictors()\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n• Yeo-Johnson transformation on: all_numeric_predictors()\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n• Scaling for: all_numeric_predictors()\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n• PCA extraction with: all_numeric_predictors()\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n• Dummy variables from: region\n```\n\n\n:::\n:::\n\n\nTo see how the data looks after preprocessing let's use the `prep()` and `juice()` function.\n\n::: {#tbl-preproc .cell tbl-cap='Preprocessed data'}\n\n```{.r .cell-code}\nlr_rec |> \n  prep() |> \n  juice() |> \n  head() |> \n  kable()\n```\n\n::: {.cell-output-display}\n\n\n|classes  |       PC1|       PC2|        PC3|        PC4|       PC5| region_Sidi.Bel.Abbes|\n|:--------|---------:|---------:|----------:|----------:|---------:|---------------------:|\n|fire     | -12.75870|  1.065189|  1.9127196|  0.1717558| 1.5907799|                     1|\n|fire     | -15.82715|  3.592703| -0.6338943| -0.1082043| 0.1228698|                     1|\n|fire     | -13.60741|  1.357303| -0.8886342| -0.0618020| 0.1017522|                     1|\n|not fire | -11.74371| -3.347725| -1.0163208|  1.2834374| 1.1943557|                     0|\n|fire     | -13.83764|  1.683620|  1.3037796|  0.2674702| 0.5054699|                     1|\n|fire     | -14.13147|  1.995548| -0.6331457|  0.3294726| 0.1962187|                     1|\n\n\n:::\n:::\n\n\nFrom @tbl-preproc we can see that the variable year has been removed.The variables has also been reduced as some of them were related, check @fig-pairs-plot\n## Workflow\n\n::: {.cell}\n\n```{.r .cell-code}\nlr_wf <- workflow() |> \n  add_model(lr_spec) |> \n  add_recipe(lr_rec) |> \n  fit(algerian_train)\n```\n:::\n\n\n## Model Result\n\n::: {.cell lable='tbl-model-sum' tbl-cap='Model summary'}\n\n```{.r .cell-code}\nlr_wf |> tidy()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 7 × 5\n  term                  estimate std.error statistic   p.value\n  <chr>                    <dbl>     <dbl>     <dbl>     <dbl>\n1 (Intercept)             -8.40      7.01     -1.20  0.230    \n2 PC1                     -0.758     0.538    -1.41  0.159    \n3 PC2                      3.43      0.847     4.05  0.0000517\n4 PC3                      0.480     0.459     1.05  0.296    \n5 PC4                      1.77      0.638     2.77  0.00558  \n6 PC5                     -0.999     0.440    -2.27  0.0231   \n7 region_Sidi.Bel.Abbes    0.356     0.959     0.371 0.711    \n```\n\n\n:::\n:::\n\nWhen all the factors are zero, the odds of fire occurring is very low, i.e. the exponential of the intercept estimate, 2.2380029\\times 10^{-4}. For region Sidi-Bel Abbes, the odds of a fire outbreak is 1.5 times higher, @tbl-model-sum.\n\n## Model Evaluation\n\n### Accuracy\n\n::: {.cell}\n\n```{.r .cell-code}\nlr_wf |> augment(algerian_test) |> \n  accuracy(classes, .pred_class)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 3\n  .metric  .estimator .estimate\n  <chr>    <chr>          <dbl>\n1 accuracy binary         0.918\n```\n\n\n:::\n:::\n\n\nThe accuracy of the model is high at 92%.\n\n### Sensitivity\n\n::: {.cell}\n\n```{.r .cell-code}\nlr_wf |> \n  augment(algerian_test) |> \n  sensitivity(classes, .pred_class)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 3\n  .metric     .estimator .estimate\n  <chr>       <chr>          <dbl>\n1 sensitivity binary         0.818\n```\n\n\n:::\n:::\n\nThe model is 82% sensitive.\n\n\n### Precision\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlr_wf |> \n  augment(algerian_test) |> \n  precision(classes, .pred_class)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 3\n  .metric   .estimator .estimate\n  <chr>     <chr>          <dbl>\n1 precision binary             1\n```\n\n\n:::\n:::\n\n### ROC-AUC\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlr_wf |> \n  augment(algerian_test) |> \n  roc_auc(classes, `.pred_not fire`)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 3\n  .metric .estimator .estimate\n  <chr>   <chr>          <dbl>\n1 roc_auc binary         0.992\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlr_wf |> \n  augment(algerian_test) |> \n  roc_curve(classes, `.pred_not fire`) |> \n  autoplot()\n```\n\n::: {.cell-output-display}\n![Area under the curve is high](index_files/figure-html/fig-roc-1.png){#fig-roc width=672}\n:::\n:::\n\n\nThe area under the curve is .99 which is very good @fig-roc.\n\n\n### Confusion Matrix\n\n::: {.cell}\n\n```{.r .cell-code}\nlr_wf |> \n  augment(algerian_test) |> \n  conf_mat(classes, .pred_class) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          Truth\nPrediction not fire fire\n  not fire       27    0\n  fire            6   40\n```\n\n\n:::\n:::\n\n\nThe model performance precision and accuracy is high above 90%, with precision at 100%. There are 6 false positives which signals the likelihood of fire when there is supposed to be non.\n\n# Summary and Conclusion\nThe project seek to predict the likelihood of fire outbreak in two regions of Algeria. A logistic regression model was employed with 6 preprocessing steps. The model developed was evaluated and has high accuracy at 92%, a high precision of 100%, 0.99 for roc_auc",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}