)
) |>
mutate(total_amount = gef_grant + cofinancing) |>
summarize(
.by = c(countries, approval_fy),
total_amount = sum(total_amount)
) |>
separate_longer_delim(
cols = countries,
delim = ","
) |>
mutate( # This block of code is needed to find the average for countries which have been
countries = str_trim(countries), # grouped together during a funding round
.by = total_amount,
fund_amount = total_amount/n(),
) |>
summarize(
.by = c(countries, approval_fy),
total_amount = sum(fund_amount)
) |>
arrange(countries)
fund_countries <- all_funds |>
filter(
!countries %in% c("Global", "Africa", "Asia/Pacific",
"Europe and Central Asia", "Latin America and Caribbean",
"Regional"
)
)
fund_region <- all_funds |>
filter(
countries %in% c("Global", "Africa", "Asia/Pacific",
"Europe and Central Asia", "Latin America and Caribbean"
)
)
countries <- list.files(path = "countries/svg", full.names = TRUE)
country_logo = tibble(logo = countries[str_detect(countries, "ch|in|me|br|ph|vn|id|za|/ng|pe")])
fund_countries |>
slice_max(total_amount, n = 10) |>
arrange(countries) |>
bind_cols(country_logo) |>
mutate( # This block ensures countries matches their logo by replacing them with abbr
logo = case_when(
str_detect(logo, "id") ~ str_replace(logo, "id", "in"),
str_detect(logo, "in") ~ str_replace(logo, "in", "id"),
str_detect(logo, "vn") ~ str_replace(logo, "vn", "za"),
str_detect(logo, "za") ~ str_replace(logo, "za", "vn"),
.default = logo
)
) |>
relocate(logo, .before = countries) |>
arrange(desc(total_amount)) |>
mutate(total_amount = round(total_amount/1e9, 2)) |>
gt() |>
cols_label(
logo = "",
countries = "Country",
total_amount = "Fund (Billion $)"
) |>
fmt_image(
columns = logo, width = 30, height = 30
) |>
tab_header(
title = "Top Funded countries with involving the GEF",
subtitle = "Funds can be by GEF, National Government and other interested parties"
) |>
gt_theme_538()
fund_countries |>
slice_max(total_amount, n = 10) |>
arrange(countries) |>
bind_cols(country_logo) |>
mutate( # This block ensures countries matches their logo by replacing them with abbr
logo = case_when(
str_detect(logo, "id") ~ str_replace(logo, "id", "in"),
str_detect(logo, "in") ~ str_replace(logo, "in", "id"),
str_detect(logo, "vn") ~ str_replace(logo, "vn", "za"),
str_detect(logo, "za") ~ str_replace(logo, "za", "vn"),
.default = logo
)
) |>
relocate(logo, .before = countries) |>
arrange(desc(total_amount)) |>
mutate(total_amount = round(total_amount/1e9, 2)) |>
select(-approval_fy) |>
gt() |>
cols_label(
logo = "",
countries = "Country",
total_amount = "Fund (Billion $)"
) |>
fmt_image(
columns = logo, width = 30, height = 30
) |>
tab_header(
title = "Top Funded countries with involving the GEF",
subtitle = "Funds can be by GEF, National Government and other interested parties"
) |>
gt_theme_538()
continent <- codelist |>
select(continent, country.name.en)
fund_countries <- fund_countries |>
left_join(continent, join_by(countries == country.name.en))
fund_countries |>
filter(is.na(continent)) |>
pull(countries)
europe <- c("Bosnia-Herzegovina", "Czech Republic", "Kosovo",
"Russian Federation", "Slovak Republic", "Türkiye")
africa <- c("Cabo Verde", "Congo", "Congo DR", "Cote d'Ivoire",
"Sao Tome and Principe")
europe <- c("Bosnia-Herzegovina", "Czech Republic", "Kosovo",
"Russian Federation", "Slovak Republic", "Türkiye")
africa <- c("Cabo Verde", "Congo", "Congo DR", "Cote d'Ivoire",
"Sao Tome and Principe")
asia <- c("Korea DPR", "Kyrgyz Republic", "Lao PDR", "Myanmar",
"Palestinian Authority", "Republic Of Korea",
"Republic Of Korea", "Viet Nam")
americas <- c("Antigua And Barbuda", "St. Kitts And Nevis",
"St. Vincent and Grenadines", "Trinidad and Tobago")
oceania <- c("Timor Leste", "Micronesia")
fund_countries <- fund_countries |>
filter(countries != "Yugoslavia") |>
mutate(
continent = case_when(
countries %in% europe ~ "Europe",
countries %in% africa ~ "Africa",
countries %in% asia ~ "Asia",
countries %in% americas ~ "Americas",
countries %in% oceania ~ "Oceania",
.default = continent
)
)
fund_countries
seq(1990, 2024, 4)
fund_countries |>
relocate(continent) |>
filter(approval_fy %in% c(selected_year))
fund_countries |>
relocate(continent) |>
filter(approval_fy %in% selected_year)
selected_year
selected_year <- seq(1990, 2024, 4)
fund_countries |>
relocate(continent) |>
filter(approval_fy %in% selected_year)
selected_year
selected_year <- seq(1991, 2024, 3)
selected_year
fund_countries |>
relocate(continent) |>
filter(approval_fy %in% selected_year)
pivot_wider(
names_from = selected_year,
values_from = total_amount
)
fund_countries |>
relocate(continent) |>
filter(approval_fy %in% selected_year) |>
pivot_wider(
names_from = selected_year,
values_from = total_amount
)
fund_countries |>
relocate(continent) |>
filter(approval_fy %in% selected_year) |>
pivot_wider(
names_from = approval_fy,
values_from = total_amount
)
fund_countries |>
relocate(continent) |>
filter(approval_fy %in% selected_year) |>
pivot_wider(
id_cols = c("continent", "countries"),
names_from = approval_fy,
values_from = total_amount
)
fund_countries |>
relocate(continent) |>
filter(approval_fy %in% selected_year)
fund_countries |>
relocate(continent) |>
filter(approval_fy %in% selected_year) |>
arrange(approval_fy)
fund_countries |>
relocate(continent) |>
filter(approval_fy %in% selected_year) |>
arrange(approval_fy) |>
pivot_wider(
id_cols = c("continent", "countries"),
names_from = approval_fy,
values_from = total_amount
)
fund_countries |>
relocate(continent) |>
filter(approval_fy %in% selected_year) |>
arrange(approval_fy) |>
pivot_wider(
id_cols = c("continent", "countries"),
names_from = approval_fy,
values_from = total_amount
) |>
group_by(continent) |>
slice_max(total_amount, n = 3)
fund_countries |>
relocate(continent) |>
filter(approval_fy %in% selected_year) |>
arrange(approval_fy) |>
pivot_wider(
id_cols = c("continent", "countries"),
names_from = approval_fy,
values_from = total_amount
) |>
group_by(continent)
fund_countries |>
relocate(continent) |>
filter(approval_fy %in% selected_year) |>
slice_max(total_amount, n = 3) |>
arrange(approval_fy)
fund_countries |>
relocate(continent) |>
filter(approval_fy %in% selected_year) |>
group_by(continent) |>
slice_max(total_amount, n = 3)
fund_countries |>
relocate(continent) |>
filter(approval_fy %in% selected_year) |>
group_by(continent) |>
slice_max(total_amount, n = 3) |>
arrange(approval_fy) |>
pivot_wider(
id_cols = c("continent", "countries"),
names_from = approval_fy,
values_from = total_amount
)
fund_countries |>
relocate(continent) |>
filter(approval_fy %in% selected_year) |>
arrange(approval_fy)
fund_countries |>
relocate(continent) |>
filter(approval_fy %in% selected_year) |>
arrange(approval_fy) |>
pivot_wider(
id_cols = c("continent", "countries"),
names_from = approval_fy,
values_from = total_amount
)
fund_countries |>
relocate(continent) |>
filter(approval_fy %in% selected_year) |>
arrange(approval_fy) |>
mutate(
amount = total_amount
) |>
pivot_wider(
id_cols = c("continent", "countries"),
names_from = approval_fy,
values_from = total_amount
)
fund_countries |>
relocate(continent) |>
filter(approval_fy %in% selected_year) |>
arrange(approval_fy) |>
mutate(
amount = total_amount
)
fund_countries |>
relocate(continent) |>
filter(approval_fy %in% selected_year) |>
arrange(approval_fy) |>
mutate(
amount = total_amount
) |>
pivot_wider(
id_cols = c("continent", "countries"),
names_from = approval_fy,
values_from = total_amount
)
fund_countries |>
relocate(continent) |>
#filter(approval_fy %in% selected_year) |>
arrange(approval_fy) |>
mutate(
amount = total_amount
) |>
pivot_wider(
id_cols = c("continent", "countries"),
names_from = approval_fy,
values_from = total_amount
)
fund_countries |>
relocate(continent) |>
#filter(approval_fy %in% selected_year) |>
arrange(approval_fy) |>
mutate(
amount = total_amount
) |>
pivot_wider(
id_cols = c("continent", "countries"),
names_from = approval_fy,
values_from = total_amount,
values_fill = 0
)
fund_countries |>
relocate(continent) |>
#filter(approval_fy %in% selected_year) |>
arrange(approval_fy) |>
mutate(
amount = total_amount
) |>
pivot_wider(
id_cols = c("continent", "countries"),
names_from = approval_fy,
values_from = total_amount,
values_fill = 0
) |>
mutate(
total_amount = sum(across(`1991`:`2023`))
)
fund_countries |>
relocate(continent) |>
#filter(approval_fy %in% selected_year) |>
arrange(approval_fy) |>
mutate(
amount = total_amount
) |>
pivot_wider(
id_cols = c("continent", "countries"),
names_from = approval_fy,
values_from = total_amount,
values_fill = 0
) |>
mutate(
total_amount = c_across(`1991`:`2023`, sum)
)
?c_across
fund_countries |>
relocate(continent) |>
#filter(approval_fy %in% selected_year) |>
arrange(approval_fy) |>
mutate(
amount = total_amount
) |>
pivot_wider(
id_cols = c("continent", "countries"),
names_from = approval_fy,
values_from = total_amount,
values_fill = 0
) |>
rowwise() |>
mutate(
total_amount = sum(c_across(`1991`:`2023`))
)
fund_countries |>
relocate(continent) |>
#filter(approval_fy %in% selected_year) |>
arrange(approval_fy) |>
mutate(
amount = total_amount
) |>
pivot_wider(
id_cols = c("continent", "countries"),
names_from = approval_fy,
values_from = total_amount,
values_fill = 0
) |>
rowwise() |>
mutate(
total_amount = sum(c_across(`1991`:`2023`))
) |>
select(continent, countries, selected_year)
selected_year
fund_countries |>
relocate(continent) |>
#filter(approval_fy %in% selected_year) |>
arrange(approval_fy) |>
mutate(
amount = total_amount
) |>
pivot_wider(
id_cols = c("continent", "countries"),
names_from = approval_fy,
values_from = total_amount,
values_fill = 0
) |>
rowwise() |>
mutate(
total_amount = sum(c_across(`1991`:`2023`))
) |>
select(continent, countries, c(selected_year))
fund_countries |>
relocate(continent) |>
#filter(approval_fy %in% selected_year) |>
arrange(approval_fy) |>
mutate(
amount = total_amount
) |>
pivot_wider(
id_cols = c("continent", "countries"),
names_from = approval_fy,
values_from = total_amount,
values_fill = 0
) |>
rowwise() |>
mutate(
total_amount = sum(c_across(`1991`:`2024`))
) |>
select(continent, countries, c(selected_year))
fund_countries |>
relocate(continent) |>
#filter(approval_fy %in% selected_year) |>
arrange(approval_fy) |>
mutate(
amount = total_amount
) |>
pivot_wider(
id_cols = c("continent", "countries"),
names_from = approval_fy,
values_from = total_amount,
values_fill = 0
) |>
rowwise() |>
mutate(
total_amount = sum(c_across(`1991`:`2024`))
) |>
select(continent, countries, c(as_character(selected_year)))
as_character(1991)
fund_countries |>
relocate(continent) |>
#filter(approval_fy %in% selected_year) |>
arrange(approval_fy) |>
mutate(
amount = total_amount
) |>
pivot_wider(
id_cols = c("continent", "countries"),
names_from = approval_fy,
values_from = total_amount,
values_fill = 0
) |>
rowwise() |>
mutate(
total_amount = sum(c_across(`1991`:`2024`))
) |>
select(continent, countries, c(as.character(selected_year)))
2024/10
2024 - 1991
2024 - 1991
(2024 - 1991) / 7
selected_year <- seq(1991, 2024, 6)
(2024 - 1991) / 6
selected_year
selected_year <- seq(1991, 2024, 5)
selected_year
selected_year <- seq(1991, 2024, 4)
selected_year
selected_year <- seq(1991, 2026, 5)
selected_year
1991 + 5
1991 + 5 +5
1991 + 7 + 7
1991 + 7 + 7 + 7
1991 + 7 + 7 + 7 + 7
2024 - 5
2024 - 5 - 5 - 5
2024 - 5 - 5 - 5 - 5 - 5 - 5 - 5 - 5
2024 - 5 - 5 - 5 - 5 - 5 - 5 - 5
2024 - 5 - 5 - 5 - 5 - 5 - 5
selected_year <- seq(1989, 2024, 5)
fund_countries |>
relocate(continent) |>
#filter(approval_fy %in% selected_year) |>
arrange(approval_fy) |>
mutate(
amount = total_amount
) |>
pivot_wider(
id_cols = c("continent", "countries"),
names_from = approval_fy,
values_from = total_amount,
values_fill = 0
) |>
rowwise() |>
mutate(
total_amount = sum(c_across(`1991`:`2024`))
) |>
select(continent, countries, c(as.character(selected_year)))
selected_year <- seq(1991, 2024, 5)
fund_countries |>
relocate(continent) |>
#filter(approval_fy %in% selected_year) |>
arrange(approval_fy) |>
mutate(
amount = total_amount
) |>
pivot_wider(
id_cols = c("continent", "countries"),
names_from = approval_fy,
values_from = total_amount,
values_fill = 0
) |>
rowwise() |>
mutate(
total_amount = sum(c_across(`1991`:`2024`))
) |>
select(continent, countries, c(as.character(selected_year)))
2024 - 1991
33/3
33/6
33/11
33/6
33/7
33/8
