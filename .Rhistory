str(algerian_ff)
#| label: fig-tgt-plot
#| fig-cap: "Frequency of Classes"
algerian_ff |>
count(classes) |>
ggplot(aes(classes, n, fill = classes)) +
geom_bar(stat = "identity") +
geom_text(
aes(label = n),
nudge_y = 11.5,
size = 4,
col = "#ff3000"
) +
scale_fill_colorblind() +
labs(
x = "Classes",
y = "Count",
title = "Frequency of Fire Occurrence Situation"
) +
coord_cartesian(ylim = c(0, 145)) +
scale_y_continuous(breaks = seq(0, 145, 29)) +
theme(
legend.position = "none",
plot.title = element_text(hjust = .5)
)
#| message: false
#| warning: false
#| label: fig-pairs-plot
#| fig-cap: Predictors plots
algerian_ff |>
select(-classes) |>
GGally::ggpairs(
title = "Predictors"
) +
theme_bw()
#| label: fig-reg-class
#| fig-cap: "There are more fire outbreak in  Sidi-Bel Abbes than in Bejaia"
algerian_ff |>
summarize(
.by = c(classes, region),
count = n()
) |>
ggplot(aes(region, count, fill = fct_reorder(classes, count))) +
geom_col(position = "dodge") +
geom_text(
aes(label = count),
size = 3.2,
vjust = -.2,
position = position_dodge(width = 1)
# position = position_nudge(x = 0, y =1)
) +
scale_fill_calc() +
labs(
fill = "Region",
x = "Classes",
y = "Count",
title = "Frequency of Fire Occurrence Situation Across Regions",
subtitle = "There's more fire outbreak in Sidi-Bel Abbes than in Bejaia"
)
algerian_ff |>
ggplot(aes(rain, temperature, col = classes)) +
geom_jitter() +
scale_color_wsj() +
labs(
x = "Rain",
y = "Temperature",
title = "Temperature vs Rain relationship for Fire Occurrence",
subtitle = "Fire rarely occur on days with high rainfall"
) +
theme(plot.subtitle = element_text(size = 10))
#| label: fig-rh-class
#| fig-cap: "Relative humidity of each days across the months showing the occurrence of fire."
#| fig-subcap: true
#| layout-nrow: 2
algerian_ff |>
ggplot(aes(day, rh, colour = classes)) +
geom_point() +
labs(
x = "Day",
y = "Relative Humidity (%)",
title = "Fire occurence for each days in a month given the day's humidity"
) +
facet_wrap(~month)
algerian_ff |>
ggplot(aes(day, rh, colour = classes)) +
geom_point() +
labs(
x = "Day",
y = "Relative Humidity (%)",
title = "Fire occurence for each days in a month for a region given the day's humidity"
) +
facet_grid(region~month)
#| label: tbl-distro
#| tbl-cap: Distribution of the targer variable across regions
set.seed(123)
algerian_split <- initial_split(algerian_ff, prop = .7)
algerian_train <- training(algerian_split)
algerian_train |>
count(region, classes)
algerian_folds <- vfold_cv(algerian_train, v = 10)
algerian_folds
logistic_reg() |>
set_mode("classification") |>
set_engine("glm") |>
translate()
lr_spec <- logistic_reg() |>
set_mode("classification") |>
set_engine("glm")
lr_spec
lr_spec |>
translate()
recipe(
classes ~ ., data = algerian_train
) |>
step_zv() |>
step_nzv() |>
step_YeoJohnson() |>
step_scale() |>
step_dummy(one_hot = TRUE)
lr_rec <- recipe(
classes ~ ., data = algerian_train
) |>
step_zv() |>
step_nzv() |>
step_YeoJohnson() |>
step_scale() |>
step_dummy(one_hot = TRUE)
lr_rec
lr_rec <- recipe(
classes ~ ., data = algerian_train
) |>
step_zv(all_numeric_predictors()) |>
step_nzv(all_numeric_predictors()) |>
step_YeoJohnson(all_numeric_predictors()) |>
step_scale(all_numeric_predictors()) |>
step_dummy(all_factor_predictors(),one_hot = TRUE)
lr_rec
lr_wf <- workflow() |>
add_model(lr_spec) |>
add_recipe(lr_rec) |>
fit_resamples(algerian_folds)
#| label: load-libraries
library(pacman)
p_load(tidyverse, tidymodels, knitr, ggthemes, hrbrthemes)
theme_set(theme_ipsum_ps(base_size = 12))
algeria_ff <- read_csv("data/Algerian_forest_fires_dataset_UPDATE.csv", skip = 1) |>
janitor::clean_names()
#| label: tbl-data-preview
#| tbl-cap: "Data preview"
#| tbl-subcap: true
algeria_ff |>
head() |>
kable()
algeria_ff |>
tail() |>
kable()
algeria_ff |>
car::some() |>
kable()
#| label: tbl-data-prop
#| tbl-cap: "Data Properties"
#| tbl-subcap: true
skimr::skim(algeria_ff)
#| label: tbl-missing
#| tbl-cap: Missing data
algeria_ff |>
filter(is.na(classes)) |>  kable()
#| label: tbl-add-row
#| tbl-cap: Row numbers added
algeria_ff <- algeria_ff |>
mutate(
id = row_number(),
.before = day
)
head(algeria_ff) |> kable()
#| label: tbl-missing-2
algeria_ff |>
filter(is.na(classes))
#| label: tbl-region
#| tbl-cap: Number of observations for the regions
algerian_ff <- algeria_ff |>
mutate(
region = case_when(id <= 122 ~ "Bejaia",
.default = "Sidi-Bel Abbes"),
.before = day,
.keep = "unused"
)
head(algerian_ff)
algerian_ff |>
filter(if_any(everything(), is.na)) |>
kable()
algerian_ff <- algerian_ff |>
drop_na() |>
filter(classes %in% c("not fire", "fire"))
algerian_ff <- algerian_ff |>
mutate(
region = factor(region),
classes = factor(classes),
across(where(is.character), parse_number)
)
str(algerian_ff)
#| label: fig-tgt-plot
#| fig-cap: "Frequency of Classes"
algerian_ff |>
count(classes) |>
ggplot(aes(classes, n, fill = classes)) +
geom_bar(stat = "identity") +
geom_text(
aes(label = n),
nudge_y = 11.5,
size = 4,
col = "#ff3000"
) +
scale_fill_colorblind() +
labs(
x = "Classes",
y = "Count",
title = "Frequency of Fire Occurrence Situation"
) +
coord_cartesian(ylim = c(0, 145)) +
scale_y_continuous(breaks = seq(0, 145, 29)) +
theme(
legend.position = "none",
plot.title = element_text(hjust = .5)
)
#| message: false
#| warning: false
#| label: fig-pairs-plot
#| fig-cap: Predictors plots
algerian_ff |>
select(-classes) |>
GGally::ggpairs(
title = "Predictors"
) +
theme_bw()
#| label: fig-reg-class
#| fig-cap: "There are more fire outbreak in  Sidi-Bel Abbes than in Bejaia"
algerian_ff |>
summarize(
.by = c(classes, region),
count = n()
) |>
ggplot(aes(region, count, fill = fct_reorder(classes, count))) +
geom_col(position = "dodge") +
geom_text(
aes(label = count),
size = 3.2,
vjust = -.2,
position = position_dodge(width = 1)
# position = position_nudge(x = 0, y =1)
) +
scale_fill_calc() +
labs(
fill = "Region",
x = "Classes",
y = "Count",
title = "Frequency of Fire Occurrence Situation Across Regions",
subtitle = "There's more fire outbreak in Sidi-Bel Abbes than in Bejaia"
)
algerian_ff |>
ggplot(aes(rain, temperature, col = classes)) +
geom_jitter() +
scale_color_wsj() +
labs(
x = "Rain",
y = "Temperature",
title = "Temperature vs Rain relationship for Fire Occurrence",
subtitle = "Fire rarely occur on days with high rainfall"
) +
theme(plot.subtitle = element_text(size = 10))
#| label: fig-rh-class
#| fig-cap: "Relative humidity of each days across the months showing the occurrence of fire."
#| fig-subcap: true
#| layout-nrow: 2
algerian_ff |>
ggplot(aes(day, rh, colour = classes)) +
geom_point() +
labs(
x = "Day",
y = "Relative Humidity (%)",
title = "Fire occurence for each days in a month given the day's humidity"
) +
facet_wrap(~month)
algerian_ff |>
ggplot(aes(day, rh, colour = classes)) +
geom_point() +
labs(
x = "Day",
y = "Relative Humidity (%)",
title = "Fire occurence for each days in a month for a region given the day's humidity"
) +
facet_grid(region~month)
#| label: tbl-distro
#| tbl-cap: Distribution of the targer variable across regions
set.seed(123)
algerian_split <- initial_split(algerian_ff, prop = .7)
algerian_train <- training(algerian_split)
algerian_train |>
count(region, classes)
algerian_folds <- vfold_cv(algerian_train, v = 10)
lr_spec <- logistic_reg() |>
set_mode("classification") |>
set_engine("glm")
lr_spec |>
translate()
lr_rec <- recipe(
classes ~ ., data = algerian_train
) |>
step_zv(all_numeric_predictors()) |>
step_nzv(all_numeric_predictors()) |>
step_YeoJohnson(all_numeric_predictors()) |>
step_scale(all_numeric_predictors()) |>
step_dummy(all_factor_predictors(),one_hot = TRUE)
lr_rec
lr_wf <- workflow() |>
add_model(lr_spec) |>
add_recipe(lr_rec) |>
fit_resamples(algerian_folds)
lr_wf
show_notes(.Last.tune.result)
lr_rec
glm(classes ~ ., data = algerian_train, family = "binomial")
lr_wf |>
summary()
lr_wf |>
collect_metrics()
lr_rec |>
prep() |>
juice()
algerian_ff
algerian_ff$classes
#| label: load-libraries
library(pacman)
p_load(tidyverse, tidymodels, knitr, ggthemes, hrbrthemes)
theme_set(theme_ipsum_ps(base_size = 12))
algeria_ff <- read_csv("data/Algerian_forest_fires_dataset_UPDATE.csv", skip = 1) |>
janitor::clean_names()
#| label: tbl-data-preview
#| tbl-cap: "Data preview"
#| tbl-subcap: true
algeria_ff |>
head() |>
kable()
algeria_ff |>
tail() |>
kable()
algeria_ff |>
car::some() |>
kable()
#| label: tbl-data-prop
#| tbl-cap: "Data Properties"
#| tbl-subcap: true
skimr::skim(algeria_ff)
#| label: tbl-missing
#| tbl-cap: Missing data
algeria_ff |>
filter(is.na(classes)) |>  kable()
#| label: tbl-add-row
#| tbl-cap: Row numbers added
algeria_ff <- algeria_ff |>
mutate(
id = row_number(),
.before = day
)
head(algeria_ff) |> kable()
#| label: tbl-missing-2
algeria_ff |>
filter(is.na(classes))
#| label: tbl-region
#| tbl-cap: Number of observations for the regions
algerian_ff <- algeria_ff |>
mutate(
region = case_when(id <= 122 ~ "Bejaia",
.default = "Sidi-Bel Abbes"),
.before = day,
.keep = "unused"
)
head(algerian_ff)
algerian_ff |>
filter(if_any(everything(), is.na)) |>
kable()
algerian_ff |>
mutate(
region = factor(region),
classes = factor(classes, labels = c("fire", "not fire"), level = c(0,1 )),
across(where(is.character), parse_number)
)
algerian_ff <- algerian_ff |>
drop_na() |>
filter(classes %in% c("not fire", "fire"))
algerian_ff |>
mutate(
region = factor(region),
classes = factor(classes, labels = c("fire", "not fire"), level = c(0,1 )),
across(where(is.character), parse_number)
)
algerian_ff |>
mutate(
region = factor(region),
classes = factor(classes, labels = c("fire", "not fire"), level = c(1,0 )),
across(where(is.character), parse_number)
)
algerian_ff |>
mutate(
region = factor(region),
classes = factor(classes, labels = c("fire", "not fire"), levels = c(1,0 )),
across(where(is.character), parse_number)
)
algerian_ff |>
mutate(
region = factor(region),
classes = factor(classes, labels = c("fire", "not fire"), levels = c("fire" ,"not fire")),
across(where(is.character), parse_number)
)
algerian_ff <- algerian_ff |>
mutate(
region = factor(region),
classes = factor(classes, labels = c("fire", "not fire"), levels = c("fire" ,"not fire")),
across(where(is.character), parse_number)
)
str(algerian_ff)
summary(algerian_ff$classes)
levels(algerian_ff$classes)
algerian_ff <- algerian_ff |>
mutate(
region = factor(region),
classes = ifelse(classes == "not fire", 0, 1),
classes = factor(classes, labels = c("fire", "not fire"), levels = c("fire" ,"not fire")),
across(where(is.character), parse_number)
)
levels(algerian_ff$classes)
summary(algerian_ff$classes)
#| label: load-libraries
library(pacman)
p_load(tidyverse, tidymodels, knitr, ggthemes, hrbrthemes)
theme_set(theme_ipsum_ps(base_size = 12))
algeria_ff <- read_csv("data/Algerian_forest_fires_dataset_UPDATE.csv", skip = 1) |>
janitor::clean_names()
#| label: tbl-data-preview
#| tbl-cap: "Data preview"
#| tbl-subcap: true
algeria_ff |>
head() |>
kable()
algeria_ff |>
tail() |>
kable()
algeria_ff |>
car::some() |>
kable()
#| label: tbl-data-prop
#| tbl-cap: "Data Properties"
#| tbl-subcap: true
skimr::skim(algeria_ff)
#| label: tbl-missing
#| tbl-cap: Missing data
algeria_ff |>
filter(is.na(classes)) |>  kable()
#| label: tbl-add-row
#| tbl-cap: Row numbers added
algeria_ff <- algeria_ff |>
mutate(
id = row_number(),
.before = day
)
head(algeria_ff) |> kable()
#| label: tbl-missing-2
algeria_ff |>
filter(is.na(classes))
#| label: tbl-region
#| tbl-cap: Number of observations for the regions
algerian_ff <- algeria_ff |>
mutate(
region = case_when(id <= 122 ~ "Bejaia",
.default = "Sidi-Bel Abbes"),
.before = day,
.keep = "unused"
)
head(algerian_ff)
algerian_ff |>
filter(if_any(everything(), is.na)) |>
kable()
algerian_ff <- algerian_ff |>
drop_na() |>
filter(classes %in% c("not fire", "fire"))
algerian_ff |>
mutate(
region = factor(region),
classes = ifelse(classes == "not fire", 0, 1),
classes = factor(classes, labels = c("fire", "not fire"), levels = c(1 ,0)),
across(where(is.character), parse_number)
)
algerian_ff <- algerian_ff |>
mutate(
region = factor(region),
classes = ifelse(classes == "not fire", 0, 1),
classes = factor(classes, labels = c("fire", "not fire"), levels = c(1 ,0)),
across(where(is.character), parse_number)
)
str(algerian_ff)
unique(algerian_ff$classes)
integer(algerian_ff$classes)
as.integer(algerian_ff$classes)
algerian_ff
algerian_ff |>
mutate(
classes = fct_shift(classes)
)
algerian_ff |>
mutate(
classes = fct_shift(classes)
) |>
